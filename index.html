<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Futures Signal Generator</title>
  <style>
    body {
      background: black;
      font-family: monospace;
      color: #00ff00;
      text-align: center;
      padding: 20px;
    }
    select, button {
      background: black;
      color: #00ff00;
      border: 2px solid #00ff00;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      font-size: 1em;
      width: 80%;
    }
    #output {
      border: 2px solid #00ff00;
      border-radius: 15px;
      padding: 20px;
      margin-top: 20px;
      background: #111;
      box-shadow: 0 0 15px #00ff00;
    }
  </style>
</head>
<body>

  <h2>Futures Signal Generator</h2>

  <select id="tokenList"></select>
  <button onclick="generateSignal()">Generate 15m Signal</button>

  <div id="output"></div>

  <script>
  let allSymbols = [];

  async function loadSymbols() {
    const res = await fetch("https://fapi.binance.com/fapi/v1/exchangeInfo");
    const data = await res.json();
    allSymbols = data.symbols
      .filter(s => s.quoteAsset === "USDT" && s.contractType === "PERPETUAL" && s.status === "TRADING")
      .map(s => s.symbol);

    const select = document.getElementById("tokenList");
    allSymbols.forEach(sym => {
      const opt = document.createElement("option");
      opt.value = sym;
      opt.textContent = sym;
      select.appendChild(opt);
    });
  }

  async function fetchKlines(symbol) {
    try {
      const url = `https://fapi.binance.com/fapi/v1/klines?symbol=${symbol}&interval=15m&limit=100`;
      const res = await fetch(url);
      const data = await res.json();
      return data.map(d => ({
        close: parseFloat(d[4]),
        high: parseFloat(d[2]),
        low: parseFloat(d[3]),
        volume: parseFloat(d[5])
      }));
    } catch (e) {
      return null;
    }
  }

  function EMA(prices, length) {
    const k = 2 / (length + 1);
    let ema = prices.slice(0, length).reduce((a, b) => a + b) / length;
    const result = [ema];
    for (let i = length; i < prices.length; i++) {
      ema = prices[i] * k + ema * (1 - k);
      result.push(ema);
    }
    return result;
  }

  function RSI(prices, period = 14) {
    let gains = 0, losses = 0;
    for (let i = 1; i <= period; i++) {
      let diff = prices[i] - prices[i - 1];
      if (diff > 0) gains += diff;
      else losses -= diff;
    }
    let avgGain = gains / period;
    let avgLoss = losses / period;
    for (let i = period + 1; i < prices.length; i++) {
      let diff = prices[i] - prices[i - 1];
      if (diff > 0) {
        avgGain = (avgGain * (period - 1) + diff) / period;
        avgLoss = (avgLoss * (period - 1)) / period;
      } else {
        avgGain = (avgGain * (period - 1)) / period;
        avgLoss = (avgLoss * (period - 1) - diff) / period;
      }
    }
    const rs = avgLoss === 0 ? 100 : avgGain / avgLoss;
    return 100 - (100 / (1 + rs));
  }

  function MACD(prices) {
    const ema12 = EMA(prices, 12);
    const ema26 = EMA(prices, 26);
    const minLength = Math.min(ema12.length, ema26.length);
    const macdLine = [];
    for (let i = 0; i < minLength; i++) {
      macdLine.push(ema12[ema12.length - minLength + i] - ema26[ema26.length - minLength + i]);
    }
    const signalLine = EMA(macdLine, 9);
    const histLength = Math.min(macdLine.length, signalLine.length);
    const histogram = [];
    for (let i = 0; i < histLength; i++) {
      histogram.push(macdLine[macdLine.length - histLength + i] - signalLine[signalLine.length - histLength + i]);
    }
    return {
      macdLine: macdLine.at(-1),
      signalLine: signalLine.at(-1),
      histogram: histogram.at(-1)
    };
  }

  async function generateSignal() {
Â  const output = document.getElementById("output");
Â  output.innerHTML = "Scanning tokens for signals...";

Â  let signals = "";

Â  for (const symbol of allSymbols) {
Â  Â  const klines = await fetchKlines(symbol);
Â  Â  if (!klines || klines.length < 99) continue;

Â  Â  const closes = klines.map(k => k.close);
Â  Â  const price = closes.at(-1);
Â  Â  const ema7 = EMA(closes, 7).at(-1);
Â  Â  const ema25 = EMA(closes, 25).at(-1);
Â  Â  const ema99 = EMA(closes, 99).at(-1);
Â  Â  const rsi = RSI(closes);
Â  Â  const macd = MACD(closes);

Â  Â  const volumes = klines.map(k => k.volume);
Â  Â  const avgVolume = volumes.slice(-20).reduce((a, b) => a + b) / 20;
Â  Â  const currentVolume = volumes.at(-1);
Â  Â  const isHighVolume = currentVolume > avgVolume * 1.05;

Â  Â  const highs = klines.map(k => k.high);
Â  Â  const lows = klines.map(k => k.low);
Â  Â  const recentVolatility = highs.slice(-20).map((h, i) => h - lows.slice(-20)[i]);
Â  Â  const avgVolatility = recentVolatility.reduce((a, b) => a + b) / 20;
Â  Â  const isVolatile = avgVolatility > price * 0.005;

Â  Â  // Indicator checks
Â  Â  const emaBullish = price > ema7 && ema7 > ema25 && ema25 > ema99;
Â  Â  const emaBearish = price < ema7 && ema7 < ema25 && ema25 < ema99;
Â  Â  const rsiBullish = rsi > 55;
Â  Â  const rsiBearish = rsi < 45;
Â  Â  const macdBullish = macd.histogram > 0;
Â  Â  const macdBearish = macd.histogram < 0;

Â  Â  let passedConditions = 0;
Â  Â  let signal = "NO SIGNAL";

Â  Â  // Count matched conditions
Â  Â  if (emaBullish) passedConditions++;
Â  Â  if (rsiBullish) passedConditions++;
Â  Â  if (macdBullish) passedConditions++;
Â  Â  if (isHighVolume) passedConditions++;
Â  Â  if (isVolatile) passedConditions++;

Â  Â  if (passedConditions >= 4) {
Â  Â  Â  signal = "LONG";
Â  Â  }

Â  Â  passedConditions = 0;
Â  Â  if (emaBearish) passedConditions++;
Â  Â  if (rsiBearish) passedConditions++;
Â  Â  if (macdBearish) passedConditions++;
Â  Â  if (isHighVolume) passedConditions++;
Â  Â  if (isVolatile) passedConditions++;

Â  Â  if (signal === "NO SIGNAL" && passedConditions >= 4) {
Â  Â  Â  signal = "SHORT";
Â  Â  }

Â  Â  // Confidence Level
Â  Â  let confidence = "LOW";
Â  Â  if (passedConditions === 5) confidence = "HIGH";
Â  Â  else if (passedConditions === 4) confidence = "MEDIUM";

Â  Â  if (signal !== "NO SIGNAL" && confidence === "HIGH") {
Â  Â  Â  const tp = (signal === "LONG" ? price * 1.03 : price * 0.97).toFixed(4);
Â  Â  Â  const sl = (signal === "LONG" ? price * 0.985 : price * 1.015).toFixed(4); // 1.5% SL
Â  Â  Â  signals += `
Â  Â  Â  Â  <div style="margin-bottom:20px;">
Â  Â  Â  Â  Â  <b>ğŸ“Š Symbol:</b> ${symbol}<br>
Â  Â  Â  Â  Â  <b>ğŸš¨ SIGNAL:</b> <span style="color:${signal === "LONG" ? "#00ff00" : "#ff3333"}">${signal}</span><br>
Â  Â  Â  Â  Â  <b>ğŸ’° Entry:</b> ${price.toFixed(4)}<br>
Â  Â  Â  Â  Â  <b>â­ TP:</b> ${tp}<br>
Â  Â  Â  Â  Â  <b>â›” SL:</b> ${sl}<br>
Â  Â  Â  Â  Â  <b>âš™ï¸ Leverage:</b> 10â€“20x<br>
Â  Â  Â  Â  Â  <b>â±ï¸ Timeframe:</b> 15m<br>
Â  Â  Â  Â  Â  <b>âœ… Confidence:</b> ${confidence}<br>
Â  Â  Â  Â  </div>
Â  Â  Â  `;
Â  Â  }
Â  }

Â  output.innerHTML = signals || "No high-confidence signals at the moment.";
}

  loadSymbols();
</script>
</body>
</html>
